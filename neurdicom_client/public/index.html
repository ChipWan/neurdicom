<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    <!--
      manifest.json provides metadata used when your web app is added to the
      homescreen on Android. See https://developers.google.com/web/fundamentals/engage-and-retain/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json">
    <link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico">
    <!--<script src="%PUBLIC_URL%/cornerstone-core/cornerstone.min.js"></script>-->
    <!--<script src="%PUBLIC_URL%/cornerstone-wado-image-loader/cornerstoneWADOImageLoader.min.js"></script>-->
    <!--<script src="%PUBLIC_URL%/cornerstone-wado-image-loader/cornerstoneWADOImageLoaderCodecs.min.js"></script>-->
    <!--<script src="%PUBLIC_URL%/cornerstone-wado-image-loader/cornerstoneWADOImageLoaderWebWorker.min.js"></script>-->
    <title>React App</title>
</head>
<body>
<noscript>
    You need to enable JavaScript to run this app.
</noscript>
<script id="mainVert" type="x-shader/x-vertex">
    varying vec2 vUv;

    void main() {
        vUv = uv;

        gl_Position =   projectionMatrix *
                        modelViewMatrix *
                        vec4(position,1.0);
    }



</script>
<script id="mainFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        gl_FragColor = vec4(texture2D(texture, vUv).rgb, 1.0);
    }
</script>

<script id="blendFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;
    uniform sampler2D mask;
    uniform float alpha;

    varying vec2 vUv;

    void main() {
        vec3 textureColor = texture2D(texture, vUv).rgb;
        vec3 maskColor = texture2D(mask, vUv).rgb;
        if(maskColor.r > 0.0){
            gl_FragColor = vec4(textureColor * (1.0 - alpha) + vec3(1.0, 0.0, 0.0) * alpha, 1.0);
        }
        else{
            gl_FragColor = vec4(textureColor, 1.0);
        }
    }
</script>

<script id="cropFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;
    uniform sampler2D mask;

    varying vec2 vUv;

    void main() {
        vec3 textureColor = texture2D(texture, vUv).rgb;
        float maskColor = texture2D(mask, vUv).r;
        vec3 outputColor;
        if(maskColor > 0.0){
            outputColor = textureColor;
        }
        else{
            outputColor = vec3(0.0);
        }
        gl_FragColor = vec4(outputColor, 1.0);
    }
</script>

<script id="heatmapFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        vec4 t = texture2D(texture, vUv);
        gl_FragColor = vec4(clamp(vec3(1.5) - abs(4.0 * vec3(t) + vec3(-3, -2, -1)), vec3(0), vec3(1)), 1.0);
    }
</script>

<script id="inverseHeatmapFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        vec4 t = texture2D(texture, vUv);
        gl_FragColor = vec4(vec3(1.0) - clamp(vec3(1.5) - abs(4.0 * vec3(t) + vec3(-3, -2, -1)), vec3(0), vec3(1)), 1.0);
    }
</script>

<script id="hotRedFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        vec4 t = texture2D(texture, vUv);
        gl_FragColor = vec4(t.r, 0.0, 0.0, 1.0);
    }
</script>

<script id="hotGreenFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        vec4 t = texture2D(texture, vUv);
        gl_FragColor = vec4(0.0, t.g, 0.0, 1.0);
    }
</script>

<script id="hotBlueFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        vec4 t = texture2D(texture, vUv);
        gl_FragColor = vec4(0.0, 0.0, t.b, 1.0);
    }
</script>

<script id="inverseFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    void main() {
        vec4 t = texture2D(texture, vUv);
        gl_FragColor = vec4(vec3(1.0) - t.rgb, 1.0);
    }
</script>

<script id="sobelFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;
//    uniform float threshold;
    varying vec2 vUv;

    #define KERNEL_SIZE 9

    uniform float kernel[9];
    uniform vec2 offset[9];

    float textureSize;

    const vec3 factor = vec3(0.27, 0.67, 0.06);

    vec3 gray(in vec3 t){
        return vec3(dot(factor, t));
    }

    vec3 gaussian(in vec2 coord, in sampler2D t){
        vec3 res = vec3(0);
        vec2 pstep = vec2(1.0) / vec2(128);
        res += texture2D(t, coord + vec2(-1.0, -1.0) * pstep).rgb;
        res += 2.0 * texture2D(t, coord + vec2(0.0, -1.0) * pstep).rgb;
        res += texture2D(t, coord + vec2(1.0, -1.0) * pstep).rgb;

        res += 2.0 * texture2D(t, coord + vec2(-1.0, 0.0) * pstep).rgb;
        res += 4.0 * texture2D(t, coord + vec2(0.0, 0.0) * pstep).rgb;
        res += 2.0 * texture2D(t, coord + vec2(1.0, 0.0) * pstep).rgb;

        res += texture2D(t, coord + vec2(-1.0, 1.0) * pstep).rgb;
        res += 2.0 * texture2D(t, coord + vec2(0.0, 1.0) * pstep).rgb;
        res += texture2D(t, coord + vec2(1.0, 1.0) * pstep).rgb;
        res /= vec3(16.0);
        return res;
    }

    vec3 sobel_x(in vec2 coord, in sampler2D t){
        vec3 res = vec3(0);
        vec2 pstep = vec2(1.0) / vec2(512.0);
        res -= gray(texture2D(t, coord + vec2(-1.0, -1.0) * pstep).rgb);
        res += gray(texture2D(t, coord + vec2(1.0, -1.0) * pstep).rgb);
        res -= 2.0 * gray(texture2D(t, coord + vec2(-1.0, 0.0) * pstep).rgb);
        res += 2.0 * texture2D(t, coord + vec2(1.0, 0.0) * pstep).rgb;
        res -= gray(texture2D(t, coord + vec2(-1.0, 1.0) * pstep).rgb);
        res += gray(texture2D(t, coord + vec2(1.0, 1.0) * pstep).rgb);
        return res;
    }

    vec3 sobel_y(in vec2 coord, in sampler2D t){
        vec3 res = vec3(0);
        vec2 pstep = vec2(1.0) / vec2(512.0);
        res -= gray(texture2D(t, coord + vec2(-1.0, -1.0) * pstep).rgb);
        res -= 2.0 * gray(texture2D(t, coord + vec2(0.0, -1.0) * pstep).rgb);
        res -= 1.0 * gray(texture2D(t, coord + vec2(1.0, -1.0) * pstep).rgb);

        res += gray(texture2D(t, coord + vec2(-1.0, 0.0) * pstep).rgb);
        res += 2.0 * gray(texture2D(t, coord + vec2(0.0, 1.0) * pstep).rgb);
        res += gray(texture2D(t, coord + vec2(1.0, 1.0) * pstep).rgb);
        return res;
    }

    vec3 apply(in vec2 coord, in sampler2D t){
        float threshold = 0.5;
        vec3 x = sobel_x(coord, t);
        vec3 y = sobel_y(coord, t);
        vec3 val = sqrt(x*x + y*y);
        vec3 inp = gray(texture2D(t, coord).rgb);
        float r = inp.r;
        float g = inp.g;
        float b = inp.b;
        r = val.x > threshold ? 1.0 : 0.0;
        g = val.y > threshold ? 1.0 : 0.0;
        b = val.z > threshold ? 1.0 : 0.0;
        return gray(vec3(r, g, b));
    }


    void main(void)
    {
        vec3 texel = apply(vUv, texture);
        gl_FragColor = vec4(texel, 1.0);
    }



</script>

<script id="sharpenFrag" type="x-shader/x-fragment">
uniform sampler2D texture;
varying vec2 vUv;

#define KERNEL_SIZE 9

uniform float kernel[9];
uniform vec2 offset[9];

vec3 apply(in sampler2D colorTexture, in vec2 texcoord)
{

    vec2 pstep = vec2(1.0) / vec2(128);
	vec4 res  = vec4(0.0);

    res -= texture2D(colorTexture, texcoord + vec2(0.0, -1.0) * pstep);
    res -= texture2D(colorTexture, texcoord + vec2(-1.0, 0.0) * pstep);
    res += texture2D(colorTexture, texcoord + vec2(0.0, 0.0) * pstep) * 5.0;
    res -= texture2D(colorTexture, texcoord + vec2(1.0, 0.0) * pstep);
    res -= texture2D(colorTexture, texcoord + vec2(0.0, 1.0) * pstep);
    return vec3(res);
}

void main(void)
{
	vec3 texel = apply(texture, vUv);
	gl_FragColor = vec4(texel, 1.0);
}

</script>

<script id="embossFrag" type="x-shader/x-fragment">
uniform sampler2D texture;
varying vec2 vUv;

// Ядро свертки
#define KERNEL_SIZE 9

uniform float kernel[9];
uniform vec2 offset[9];

const vec3 factor = vec3(0.27, 0.67, 0.06);

vec3 apply(in sampler2D colorTexture, in vec2 texcoord)
{

    vec2 pstep = vec2(1.0) / vec2(128);
	vec4 res  = vec4(0.0);

    res -= 2.0 * texture2D(colorTexture, texcoord + vec2(-1.0, -1.0) * pstep);
    res -= texture2D(colorTexture, texcoord + vec2(0.0, -1.0) * pstep);
    res -= texture2D(colorTexture, texcoord + vec2(-1.0, 0.0) * pstep);
    res += texture2D(colorTexture, texcoord + vec2(0.0, 0.0) * pstep);
    res += texture2D(colorTexture, texcoord + vec2(1.0, 0.0) * pstep);
    res += texture2D(colorTexture, texcoord + vec2(0.0, 1.0) * pstep);
    res += 2.0 * texture2D(colorTexture, texcoord + vec2(1.0, 1.0) * pstep);
    return vec3(dot(factor, res.rgb));
}

void main(void)
{
	vec3 texel = apply(texture, vUv);
	gl_FragColor = vec4(texel, 1.0);
}

</script>

<script id="laplacianFrag" type="x-shader/x-fragment">
    uniform sampler2D texture;

    varying vec2 vUv;

    #define KERNEL_SIZE 9

    uniform float kernel[9];
    uniform vec2 offset[9];

    const vec3 factor = vec3(0.27, 0.67, 0.06);

    vec3 gray(in vec3 t){
        return vec3(dot(factor, t));
    }

    vec3 apply(in sampler2D colorTexture, in vec2 texcoord)
    {
        vec2 pstep = vec2(1.0) / vec2(512.0);
        vec3 res  = vec3(0.0);
        res += gray(texture2D(colorTexture, texcoord + vec2(1.0, -1.0) * pstep).rgb);
        res += gray(texture2D(colorTexture, texcoord + vec2(-1.0, 0.0) * pstep).rgb);
        res -= 4.0 * gray(texture2D(colorTexture, texcoord + vec2(1.0, -1.0) * pstep).rgb);
        res += gray(texture2D(colorTexture, texcoord + vec2(1.0, 0.0) * pstep).rgb);
        res += gray(texture2D(colorTexture, texcoord + vec2(0.0, 1.0) * pstep).rgb);
        return vec3(res);
    }

    void main(void)
    {
        vec3 texel = apply(texture, vUv);
        gl_FragColor = vec4(texel, 1.0);
    }
</script>


<div id="root" style="height: 100%; min-height: 300px; min-width: 1000px;"></div>
<script>

</script>
</body>
</html>
